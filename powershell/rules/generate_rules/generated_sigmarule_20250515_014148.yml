title: "Detection of 'whoami /user' Command Execution with Obfuscation"
id: 7281cff0-dc46-45f6-9246-db781dd5719d
status: test
description: >
  Detects the execution of the "whoami /user" command where attackers may use obfuscation
  (e.g. added quotes or altered spacing) to bypass simple string matching.
author: [your_name_here]
date: 2025-05-15
tags:
  - attack.execution
  - attack.discovery
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    EventID: 4688
    CommandLine|re:
      - '(?i)\bwhoami\b.*[/-][''"]?u[''"]?[sS][''"]?[eE][''"]?[rR][''"]?'
  condition: selection
falsepositives:
  - "Legitimate use of 'whoami /user' command for administrative or troubleshooting purposes."
level: medium
