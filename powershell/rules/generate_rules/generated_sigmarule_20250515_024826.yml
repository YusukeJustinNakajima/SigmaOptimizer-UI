title: "Suspicious CertUtil Remote Download Execution"
id: 392cd6aa-522d-4bda-915d-6b4599bf928a
status: "test"
description: >
  Detects the execution of a process where the OriginalFileName is certutil.exe
  and the CommandLine contains a remote URL (http or https). This may indicate that
  an attacker is misusing CertUtil to download files or exfiltrate data, while the use
  of the OriginalFileName field helps prevent bypass via file renaming.
author: [your_name_here]
date: 2025-05-15
tags:
  - attack.exfiltration
  - attack.t1005
  - attack.defense_evasion
logsource:
  product: "windows"
  category: "process_creation"
detection:
  selection:
    OriginalFileName: "certutil.exe"
    CommandLine|re:
      - "(?i)http[s]?://"
  condition: selection
falsepositives:
  - Legitimate administrative use of CertUtil for certificate management or controlled file retrieval.
level: medium
