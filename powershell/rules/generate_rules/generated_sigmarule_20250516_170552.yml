title: Suspicious CertUtil Execution Indicating Potential Data Exfiltration
id: bb8619c8-9f31-4cff-ad60-1d1771cadec0
status: test
description: >
  Detects execution of certutil.exe with suspicious command-line arguments such as use of a URL or a decode option.
  Such behavior may indicate that an adversary is using CertUtil as a Living-off-the-Land binary
  to download remote payloads or decode obfuscated data.
author: [your_name_here]
date: 2025-05-16
tags:
  - attack.defense_evasion
  - attack.exfiltration
  - attack.t1212
logsource:
  product: windows
  category: process_creation
detection:
  selection_certutil:
    OriginalFileName: "certutil.exe"
  selection_url:
    CommandLine|re:
      - "(?i)http[s]?://"
  selection_decode:
    CommandLine|contains:
      - "-decode"
  condition: selection_certutil and (selection_url or selection_decode)
falsepositives:
  - Legitimate administrative use of certutil for decoding files or retrieving updates from known, trusted sources.
level: medium