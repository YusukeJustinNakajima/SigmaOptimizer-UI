title: Suspicious CertUtil Execution for Remote File Download
id: fd7849c2-957e-47de-9388-e6367a2b66c4
status: test
description: >
  This rule detects the execution of CertUtil when its OriginalFileName is reported as "certutil.exe" and the
  CommandLine contains an HTTP/HTTPS URL. Such behavior is often used by attackers to download remote payloads,
  and leveraging the OriginalFileName field helps mitigate evasion via executable renaming.
author: [your_name_here]
date: 2025-05-15
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    EventID: 4688
    OriginalFileName: certutil.exe
    CommandLine|re:
      - '(?i)http[s]?://'
  condition: selection
fields:
  - OriginalFileName
  - CommandLine
  - ParentImage
falsepositives:
  - Legitimate certificate management or debugging activities that involve CertUtil.
level: high
