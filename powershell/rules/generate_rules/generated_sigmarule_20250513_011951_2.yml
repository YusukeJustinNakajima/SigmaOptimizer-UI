title: Suspicious PowerShell History Clearing Command  
id: 6eeb2412-4c31-4e68-a78c-37a1658668ed
status: test  
description: Detects PowerShell executions that bypass the normal execution policy and issue history clearing commands (Clear-History and Clear), which can be used to cover malicious activities.  
author: [your_name_here]
date: 2025-05-13
tags:  
  - attack.defense_evasion  
  - attack.t1086  
logsource:  
  product: windows  
  category: process_creation  
detection:  
  selection:  
    OriginalFileName: "PowerShell.EXE"  
    CommandLine|contains:  
      - "-ExecutionPolicy Bypass"  
      - "Clear-History"  
      - "Clear"  
  condition: all of selection  
falsepositives:  
  - Legitimate cleanup or administrative automation scripts  
level: medium
