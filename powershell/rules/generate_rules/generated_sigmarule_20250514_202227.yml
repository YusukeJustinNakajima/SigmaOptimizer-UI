title: Suspicious Certutil Execution for Malicious Downloads
id: a95fb4ea-1cf4-41cd-8969-d1a5ba383eaa
status: test
description: >
  This rule detects the execution of certutil.exe when used with command line parameters containing
  an HTTP/HTTPS URL. Such usage is often associated with misuse of certutil for downloading remote files,
  a common technique employed by adversaries. The rule leverages the OriginalFileName field to avoid
  bypasses via file renaming and excludes executions parented by explorer.exe to reduce false positives.
references:
  - https://attack.mitre.org/techniques/T1218/
author: [your_name_here]
date: 2025-05-14
modified: 2023-10-12
tags:
  - attack.execution
  - attack.t1218
  - defense-evasion
logsource:
  product: windows
  category: process_creation
detection:
  selection_certutil:
    OriginalFileName: "certutil.exe"
    CommandLine|contains:
      - "http://"
      - "https://"
  filter_explorer:
    ParentImage|endswith:
      - "\\explorer.exe"
  condition: selection_certutil and not filter_explorer
falsepositives:
  - Legitimate operations using certutil for certificate management or updates.
level: medium
