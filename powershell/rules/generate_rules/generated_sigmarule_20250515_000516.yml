title: Suspicious CertUtil Network Download Attempt
id: 8ec57257-0ca5-4481-8aac-9ede7751631e
status: test
description: >
  Detects execution of certutil.exe with commanda�?line parameters containing a network URL pattern,
  which may indicate an attempt to download or exfiltrate files using a trusted binary. By matching on
  the OriginalFileName field and a regex for a�?http(s)://a�?, this rule minimizes evasion through simple renaming.
references:
  - https://attack.mitre.org/techniques/T1105/
author: [your_name_here]
date: 2025-05-15
tags:
  - attack.exfiltration
  - attack.t1105
  - abuse.lolbins
logsource:
  product: windows
  category: process_creation
detection:
  selection_certutil:
    OriginalFileName:
      - 'certutil.exe'
      - 'CERTUTIL.EXE'
    CommandLine|re:
      - '(?i)\\b(http|https):\\/\\/'
  condition: selection_certutil
falsepositives:
  - Legitimate administrative use of certutil.exe for file download, verification, or certificate management.
level: medium